<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WildBot HFT Scalper</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #1a1b26;
    color: #c0caf5;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    padding: 20px;
    min-height: 100vh;
  }
  .mono { font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace; }
  header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid #363b54;
  }
  header h1 { font-size: 1.5rem; font-weight: 600; }
  .status-dot {
    width: 12px; height: 12px;
    border-radius: 50%;
    background: #f7768e;
    flex-shrink: 0;
  }
  .status-dot.running { background: #9ece6a; box-shadow: 0 0 8px #9ece6a88; }
  .status-label { font-size: 0.85rem; color: #565f89; }
  .grid { display: grid; gap: 16px; margin-bottom: 24px; }
  .grid-4 { grid-template-columns: repeat(4, 1fr); }
  .card {
    background: #24283b;
    border-radius: 10px;
    padding: 18px;
  }
  .card-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #565f89;
    margin-bottom: 6px;
  }
  .card-value {
    font-size: 1.4rem;
    font-weight: 600;
    transition: color 0.3s;
  }
  .section-title {
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: #565f89;
    margin-bottom: 12px;
    font-weight: 600;
  }
  .green { color: #9ece6a; }
  .red { color: #f7768e; }
  .blue { color: #7aa2f7; }
  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
  }
  .info-item {
    background: #24283b;
    border-radius: 8px;
    padding: 14px;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .info-label { font-size: 0.72rem; text-transform: uppercase; color: #565f89; letter-spacing: 0.04em; }
  .info-value { font-size: 1rem; font-weight: 500; }
  .stopped-badge {
    display: inline-block;
    background: #f7768e22;
    color: #f7768e;
    padding: 2px 10px;
    border-radius: 4px;
    font-size: 0.85rem;
    font-weight: 600;
  }
  @media (max-width: 800px) {
    .grid-4 { grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 480px) {
    .grid-4 { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
<header>
  <div class="status-dot" id="statusDot"></div>
  <h1>WildBot HFT Scalper</h1>
  <span class="status-label" id="statusLabel">connecting...</span>
</header>

<div class="grid grid-4">
  <div class="card">
    <div class="card-label">Balance</div>
    <div class="card-value mono" id="balance">—</div>
  </div>
  <div class="card">
    <div class="card-label">Equity</div>
    <div class="card-value mono" id="equity">—</div>
  </div>
  <div class="card">
    <div class="card-label">Return %</div>
    <div class="card-value mono" id="returnPct">—</div>
  </div>
  <div class="card">
    <div class="card-label">Trade Count</div>
    <div class="card-value mono blue" id="tradeCount">—</div>
  </div>
</div>

<div class="grid grid-4">
  <div class="card">
    <div class="card-label">Realized PnL</div>
    <div class="card-value mono" id="realizedPnl">—</div>
  </div>
  <div class="card">
    <div class="card-label">Unrealized PnL</div>
    <div class="card-value mono" id="unrealizedPnl">—</div>
  </div>
  <div class="card">
    <div class="card-label">Win Rate %</div>
    <div class="card-value mono" id="winRate">—</div>
  </div>
  <div class="card">
    <div class="card-label">Max Drawdown %</div>
    <div class="card-value mono red" id="maxDrawdown">—</div>
  </div>
</div>

<div class="section-title">Market Data</div>
<div class="info-grid" style="margin-bottom:24px;">
  <div class="info-item">
    <span class="info-label">Symbol</span>
    <span class="info-value blue" id="symbol">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Best Bid</span>
    <span class="info-value mono green" id="bestBid">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Best Ask</span>
    <span class="info-value mono red" id="bestAsk">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Spread (bps)</span>
    <span class="info-value mono" id="spread">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Open Orders</span>
    <span class="info-value mono blue" id="openOrders">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Position</span>
    <span class="info-value mono" id="position">—</span>
  </div>
</div>

<div class="section-title">Activity</div>
<div class="info-grid">
  <div class="info-item">
    <span class="info-label">Uptime</span>
    <span class="info-value mono" id="uptime">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Updates Processed</span>
    <span class="info-value mono blue" id="updates">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Starting Capital</span>
    <span class="info-value mono" id="startingCapital">—</span>
  </div>
  <div class="info-item">
    <span class="info-label">Status</span>
    <span class="info-value" id="stoppedStatus">—</span>
  </div>
</div>

<script>
function pnlColor(v) { return v > 0 ? 'green' : v < 0 ? 'red' : ''; }

function formatUptime(s) {
  var h = Math.floor(s / 3600);
  var m = Math.floor((s % 3600) / 60);
  var sec = Math.floor(s % 60);
  return (h > 0 ? h + 'h ' : '') + m + 'm ' + sec + 's';
}

function formatSpreadBps(spread, mid) {
  if (!mid || mid === 0) return '—';
  return ((spread / mid) * 10000).toFixed(2);
}

function update() {
  fetch('/api/status')
    .then(function(r) { return r.json(); })
    .then(function(d) {
      var dot = document.getElementById('statusDot');
      var lbl = document.getElementById('statusLabel');
      if (d.status === 'running') {
        dot.className = 'status-dot running';
        lbl.textContent = 'running';
      } else {
        dot.className = 'status-dot';
        lbl.textContent = 'stopped';
      }

      document.getElementById('balance').textContent = '$' + d.balance.toFixed(2);
      document.getElementById('equity').textContent = '$' + d.equity.toFixed(2);

      var retEl = document.getElementById('returnPct');
      retEl.textContent = d.return_pct.toFixed(2) + '%';
      retEl.className = 'card-value mono ' + pnlColor(d.return_pct);

      document.getElementById('tradeCount').textContent = d.trade_count;

      var rpEl = document.getElementById('realizedPnl');
      rpEl.textContent = '$' + d.pnl.toFixed(4);
      rpEl.className = 'card-value mono ' + pnlColor(d.pnl);

      var upEl = document.getElementById('unrealizedPnl');
      upEl.textContent = '$' + d.unrealized_pnl.toFixed(4);
      upEl.className = 'card-value mono ' + pnlColor(d.unrealized_pnl);

      document.getElementById('winRate').textContent = d.win_rate.toFixed(2) + '%';
      document.getElementById('maxDrawdown').textContent = d.max_drawdown_pct.toFixed(2) + '%';

      document.getElementById('symbol').textContent = d.symbol;

      var tob = d.tob;
      var mid = tob.mid_price || 0;
      document.getElementById('bestBid').textContent = mid > 0 ? tob.best_bid.toFixed(2) : '—';
      document.getElementById('bestAsk').textContent = mid > 0 ? tob.best_ask.toFixed(2) : '—';
      document.getElementById('spread').textContent = formatSpreadBps(tob.spread, mid);
      document.getElementById('openOrders').textContent = d.open_orders;
      document.getElementById('position').textContent = d.position;

      document.getElementById('uptime').textContent = formatUptime(d.uptime);
      document.getElementById('updates').textContent = d.updates_processed;
      document.getElementById('startingCapital').textContent = '$' + d.starting_capital.toFixed(2);

      var stEl = document.getElementById('stoppedStatus');
      if (d.is_stopped) {
        stEl.innerHTML = '<span class="stopped-badge">STOPPED — Drawdown Triggered</span>';
      } else {
        stEl.textContent = 'Active';
        stEl.className = 'info-value green';
      }
    })
    .catch(function() {
      document.getElementById('statusDot').className = 'status-dot';
      document.getElementById('statusLabel').textContent = 'disconnected';
    });
}

update();
setInterval(update, 2000);
</script>
</body>
</html>
